<div class="marketplace-container">
  <!-- HERO SECTION -->
  <section class="hero-section">
    <div class="mexican-pattern"></div>

    <div class="hero-content-wrapper">
      <div class="hero-content">
        <div class="hero-text">
          <h1 class="hero-title">
            <span class="hero-line-1">Descubre</span>
            <span class="hero-line-2">
              <span class="text-raices">Raíces</span>
              <span class="text-mx">MX</span>
            </span>
          </h1>

          <p class="hero-subtitle">Artesanías mexicanas auténticas, tradición en cada pieza</p>

          <div class="hero-cta">
            <button class="btn-explorar btn-glow-effect" (click)="scrollToProductos()">
              <i class="material-icons btn-icon">card_giftcard</i>
              <span class="btn-text">Explorar Colección</span>
            </button>
          </div>
        </div>

        <div class="hero-logo">
          <div class="logo-container">
            <img
              src="../../assets/images/Logo_RMX.png"
              alt="RaícesMX Logo"
              class="logo-img"
              (error)="onLogoError($event)"
            />
            <span class="logo-tagline">Artesanía Mexicana</span>
          </div>
        </div>
      </div>
    </div>

    <div class="scroll-indicator" (click)="scrollToProductos()">
      <div class="arrow"></div>
    </div>
  </section>

  <!-- FILTROS -->
  <section class="filtros-section">
    <div class="container">
      <div class="filtros-grid">
        <div
          class="filtro-card"
          (click)="filtrarDestacados()"
          [class.active]="filtroActivo === 'destacados'"
        >
          <div class="filtro-icon">
            <i class="material-icons">whatshot</i>
          </div>
          <div class="filtro-content">
            <h4>Destacados</h4>
            <p>Lo más popular</p>
          </div>
        </div>

        <div
          class="filtro-card"
          (click)="filtrarNovedades()"
          [class.active]="filtroActivo === 'nuevos'"
        >
          <div class="filtro-icon">
            <i class="material-icons">fiber_new</i>
          </div>
          <div class="filtro-content">
            <h4>Novedades</h4>
            <p>Productos nuevos</p>
          </div>
        </div>

        <div
          class="filtro-card"
          (click)="filtrarOfertas()"
          [class.active]="filtroActivo === 'ofertas'"
        >
          <div class="filtro-icon">
            <i class="material-icons">local_offer</i>
          </div>
          <div class="filtro-content">
            <h4>Ofertas</h4>
            <p>Hasta 50% off</p>
          </div>
        </div>

        <div
          class="filtro-card"
          (click)="filtrarPorPrecio()"
          [class.active]="filtroActivo === 'precio'"
        >
          <div class="filtro-icon">
            <i class="material-icons">attach_money</i>
          </div>
          <div class="filtro-content">
            <h4>Por Precio</h4>
            <p>Menor a mayor</p>
          </div>
        </div>
      </div>

      <div class="filtros-footer">
        <div class="productos-count">
          <span class="count-number">{{ totalProductos }}</span>
          <span class="count-text">artesanías disponibles</span>
        </div>

        <button
          class="btn-limpiar btn-glow-effect btn-glow-subtle"
          (click)="limpiarFiltros()"
          *ngIf="filtroActivo"
        >
          <i class="material-icons btn-icon">refresh</i>
          Limpiar filtro
        </button>
      </div>
    </div>
  </section>

  <!-- PRODUCTOS -->
  <section class="productos-section" id="productos" #productosSection>
    <div class="container">
      <h2 class="section-title">Nuestros Productos</h2>

      <!-- LOADING STATE -->
      <div class="loading-state" *ngIf="cargando">
        <div class="spinner"></div>
        <p>Cargando productos...</p>
      </div>

      <!-- GRID DE PRODUCTOS -->
      <div class="productos-grid" *ngIf="!cargando && productosFiltrados.length > 0">
        <div class="producto-card" *ngFor="let producto of productosFiltrados">
          <!-- IMAGEN DEL PRODUCTO -->
          <div class="product-image">
            <img
              [src]="getImagenProducto(producto)"
              [alt]="producto.titulo"
              loading="lazy"
              (error)="onImgError($event)"
            />

            <!-- BADGES -->
            <div
              class="product-badge"
              *ngIf="esProductoNuevo(producto) || esProductoPopular(producto)"
            >
              <span *ngIf="esProductoNuevo(producto)">
                <i class="material-icons">fiber_new</i> Nuevo
              </span>
              <span *ngIf="esProductoPopular(producto)">
                <i class="material-icons">whatshot</i> Popular
              </span>
            </div>

            <!-- ESTADO DEL PRODUCTO -->
            <div class="product-location">
              <i class="material-icons">location_on</i>
              <span>{{ producto.estado }}</span>
            </div>
          </div>

          <!-- INFO DEL PRODUCTO -->
          <div class="product-info">
            <div class="product-header">
              <h3 class="product-name">{{ producto.titulo }}</h3>
              <span class="product-category">
                <i class="material-icons">{{ producto.category.icono }}</i>
                {{ producto.category.nombre }}
              </span>
            </div>

            <!-- DESCRIPCIÓN CORTA -->
            <p class="product-description">
              {{
                producto.descripcion.length > 80
                  ? (producto.descripcion | slice: 0 : 80) + '...'
                  : producto.descripcion
              }}
            </p>

            <!-- PRICING -->
            <div class="product-pricing">
              <span class="current-price"> ${{ producto.precio | number: '1.0-0' }} MXN </span>
              <span class="product-unit">/ {{ producto.unidad }}</span>
            </div>

            <!-- STATS -->
            <div class="product-stats">
              <span class="stat-item">
                <i class="material-icons">visibility</i>
                {{ producto.vistas }} vistas
              </span>
              <span class="stat-item" *ngIf="producto.ventas > 0">
                <i class="material-icons">shopping_bag</i>
                {{ producto.ventas }} vendidos
              </span>
              <span class="stat-item" [class.low-stock]="producto.stock < 5">
                <i class="material-icons">inventory_2</i>
                {{ producto.stock }} disponibles
              </span>
            </div>

            <!-- VENDEDOR -->
            <div class="product-seller">
              <i class="material-icons">store</i>
              <span>{{ producto.seller.fullName }}</span>
            </div>

            <!-- ACTIONS -->
            <div class="product-actions">
              <button
                class="btn-add-cart btn-glow-effect"
                (click)="agregarAlCarrito(producto)"
                [disabled]="producto.stock === 0"
              >
                <i class="material-icons btn-icon">shopping_cart</i>
                {{ producto.stock > 0 ? 'Agregar' : 'Sin stock' }}
              </button>

              <a
                class="btn-details btn-glow-effect btn-glow-subtle"
                [routerLink]="['/producto', producto.id]"
              >
                <i class="material-icons">visibility</i>
                Ver detalles
              </a>
            </div>
          </div>
        </div>
      </div>

      <!-- ✨ PAGINACIÓN -->
      <div
        class="pagination-container"
        *ngIf="!cargando && productosFiltrados.length > 0 && totalPaginas > 1"
      >
        <div class="pagination">
          <!-- Botón Anterior -->
          <button
            class="pagination-btn pagination-arrow"
            (click)="paginaAnterior()"
            [disabled]="paginaActual === 1"
          >
            <i class="material-icons">chevron_left</i>
            Anterior
          </button>

          <!-- Números de Página -->
          <div class="pagination-numbers">
            <ng-container *ngFor="let pagina of paginasVisibles">
              <button
                *ngIf="pagina !== '...'"
                class="pagination-btn pagination-number"
                [class.active]="pagina === paginaActual"
                (click)="irAPagina(+pagina)"
              >
                {{ pagina }}
              </button>

              <span *ngIf="pagina === '...'" class="pagination-dots">...</span>
            </ng-container>
          </div>

          <!-- Botón Siguiente -->
          <button
            class="pagination-btn pagination-arrow"
            (click)="paginaSiguiente()"
            [disabled]="paginaActual === totalPaginas"
          >
            Siguiente
            <i class="material-icons">chevron_right</i>
          </button>
        </div>

        <!-- Info de Paginación -->
        <div class="pagination-info">
          Mostrando {{ (paginaActual - 1) * productosPorPagina + 1 }} -
          {{ Math.min(paginaActual * productosPorPagina, totalProductos) }}
          de {{ totalProductos }} productos
        </div>
      </div>

      <!-- NO RESULTS -->
      <div class="no-results" *ngIf="!cargando && productosFiltrados.length === 0">
        <div class="no-results-icon">
          <i class="material-icons">sentiment_dissatisfied</i>
        </div>

        <h3>No hay productos disponibles</h3>
        <p>Intenta con otros filtros o vuelve más tarde</p>

        <button class="btn-limpiar btn-glow-effect btn-glow-subtle" (click)="limpiarFiltros()">
          <i class="material-icons btn-icon">refresh</i>
          Ver todas las artesanías
        </button>
      </div>
    </div>
  </section>

  <!-- BENEFICIOS -->
  <section class="beneficios-section">
    <div class="container">
      <h2 class="beneficios-title">¿Por qué elegir RaícesMX?</h2>

      <div class="beneficios-grid">
        <div class="beneficio-card">
          <div class="beneficio-icon">
            <i class="material-icons">palette</i>
          </div>
          <h3>Hecho en México</h3>
          <p>Artesanía 100% auténtica</p>
        </div>

        <div class="beneficio-card">
          <div class="beneficio-icon">
            <i class="material-icons">local_shipping</i>
          </div>
          <h3>Envío Seguro</h3>
          <p>A todo el país</p>
        </div>

        <div class="beneficio-card">
          <div class="beneficio-icon">
            <i class="material-icons">card_giftcard</i>
          </div>
          <h3>Regalos Únicos</h3>
          <p>Empaque especial</p>
        </div>
      </div>
    </div>
  </section>

  <!-- CTA VENDEDOR -->
  <section class="vendedor-cta-section" *ngIf="mostrarCTAVendedor">
    <div class="container">
      <div class="vendedor-cta-card">
        <div class="vendedor-cta-text">
          <h2>¿Quieres empezar a vender tus productos?</h2>
          <p>
            Comparte tu talento con todo México. Verificamos a nuestros vendedores para mantener una
            comunidad segura y confiable.
          </p>
        </div>

        <div class="vendedor-cta-action">
          <button class="btn-vendedor" routerLink="/vendedor">Quiero vender en RaícesMX</button>
        </div>
      </div>
    </div>
  </section>
</div>
