<div class="perfil-container">
  <main class="perfil-main">
    <div class="perfil-content">
      <!-- Banner superior -->
      <section class="banner-superior">
        <div class="banner-content">
          <div class="bienvenida">
            <h1>Â¡Hola, {{ usuario.nombre || 'Cargando' }}!</h1>
            <p class="bienvenida-subtitle">Gestiona tu cuenta desde el panel de control</p>
          </div>

          <div class="acciones-rapidas">
            <button class="btn-accion btn-accion-primary" [routerLink]="['/publicar_producto']">
              <i class="icon-publish">ğŸ“¦</i>
              <span>Publicar Producto</span>
            </button>
            <button class="btn-accion btn-accion-secondary" [routerLink]="['/historial_compras']">
              <i class="icon-history">ğŸ›’</i>
              <span>Historial de Compras</span>
            </button>
            <!-- ELIMINADO: BotÃ³n Cerrar SesiÃ³n del banner -->
          </div>
        </div>

        <!-- Tarjetas de estadÃ­sticas -->
        <div class="estadisticas-grid">
          <div class="estadistica-card">
            <div class="estadistica-icon estadistica-icon-1">
              <i class="icon-package">ğŸ“¦</i>
            </div>
            <div class="estadistica-info">
              <span class="numero">5</span>
              <span class="label">Pedidos Activos</span>
            </div>
          </div>

          <div class="estadistica-card">
            <div class="estadistica-icon estadistica-icon-2">
              <i class="icon-star">â­</i>
            </div>
            <div class="estadistica-info">
              <span class="numero">12</span>
              <span class="label">Favoritos</span>
            </div>
          </div>

          <div class="estadistica-card">
            <div class="estadistica-icon estadistica-icon-3">
              <i class="icon-box">ğŸ</i>
            </div>
            <div class="estadistica-info">
              <span class="numero">3</span>
              <span class="label">Productos Publicados</span>
            </div>
          </div>

          <div class="estadistica-card">
            <div class="estadistica-icon estadistica-icon-4">
              <i class="icon-credit-card">ğŸ’³</i>
            </div>
            <div class="estadistica-info">
              <span class="numero">2</span>
              <span class="label">MÃ©todos de Pago</span>
            </div>
          </div>
        </div>
      </section>

      <!-- Panel principal con pestaÃ±as -->
      <div class="panel-principal">
        <!-- NavegaciÃ³n por pestaÃ±as mejorada -->
        <nav class="tabs-navigation">
          <button
            class="tab-btn"
            [class.active]="tabActiva === 'informacion'"
            (click)="cambiarTab('informacion')"
          >
            <i class="icon-user">ğŸ‘¤</i>
            InformaciÃ³n Personal
          </button>
          <button
            class="tab-btn"
            [class.active]="tabActiva === 'direcciones'"
            (click)="cambiarTab('direcciones')"
          >
            <i class="icon-location">ğŸ“</i>
            Direcciones
          </button>
          <button
            class="tab-btn"
            [class.active]="tabActiva === 'productos'"
            (click)="cambiarTab('productos')"
          >
            <i class="icon-package">ğŸ“¦</i>
            Mis Productos
          </button>
          <button
            class="tab-btn"
            [class.active]="tabActiva === 'seguridad'"
            (click)="cambiarTab('seguridad')"
          >
            <i class="icon-shield">ğŸ›¡ï¸</i>
            Seguridad
          </button>
        </nav>

        <!-- Contenido de pestaÃ±as -->
        <div class="tabs-content">
          <!-- PestaÃ±a: InformaciÃ³n Personal -->
          <div *ngIf="tabActiva === 'informacion'" class="tab-pane">
            <div class="pane-header">
              <h2><i class="icon-user">ğŸ‘¤</i> InformaciÃ³n Personal</h2>
              <div class="pane-acciones">
                <button class="btn-secundario" (click)="cerrarSesion()">
                  <i class="icon-logout">ğŸšª</i> Cerrar SesiÃ³n
                </button>
                <button class="btn-editar" (click)="toggleEdicion()">
                  {{ editando ? 'Cancelar' : 'Editar Perfil' }}
                </button>
              </div>
            </div>

            <div class="formulario-perfil">
              <div class="form-grid">
                <div class="form-group">
                  <label for="nombre">Nombre completo *</label>
                  <div *ngIf="!editando" class="info-display">{{ usuario.nombre }}</div>
                  <input
                    *ngIf="editando"
                    id="nombre"
                    type="text"
                    [(ngModel)]="usuarioEditado.nombre"
                    class="form-input"
                    placeholder="Nombre completo"
                  />
                </div>

                <div class="form-group">
                  <label for="curp">CURP *</label>
                  <div *ngIf="!editando" class="info-display">{{ usuario.curp }}</div>
                  <input
                    *ngIf="editando"
                    id="curp"
                    type="text"
                    [(ngModel)]="usuarioEditado.curp"
                    class="form-input"
                    placeholder="ABCD123456HEMLMN09"
                    maxlength="18"
                  />
                </div>

                <div class="form-group">
                  <label for="email">Correo electrÃ³nico *</label>
                  <div *ngIf="!editando" class="info-display">{{ usuario.email }}</div>
                  <input
                    *ngIf="editando"
                    id="email"
                    type="email"
                    [(ngModel)]="usuarioEditado.email"
                    class="form-input"
                    placeholder="correo@ejemplo.com"
                  />
                </div>

                <div class="form-group">
                  <label for="telefono">TelÃ©fono *</label>
                  <div *ngIf="!editando" class="info-display">{{ usuario.telefono }}</div>
                  <input
                    *ngIf="editando"
                    id="telefono"
                    type="tel"
                    [(ngModel)]="usuarioEditado.telefono"
                    class="form-input"
                    placeholder="+52 55 1234 5678"
                  />
                </div>

                <div class="form-group full-width">
                  <label for="fechaNacimiento">Fecha de nacimiento</label>
                  <div *ngIf="!editando" class="info-display">
                    {{ usuario.fechaNacimiento | date: 'longDate' }}
                  </div>
                  <input
                    *ngIf="editando"
                    id="fechaNacimiento"
                    type="date"
                    [(ngModel)]="usuarioEditado.fechaNacimiento"
                    class="form-input"
                  />
                </div>
              </div>

              <!-- Acciones del formulario -->
              <div *ngIf="editando" class="form-actions">
                <button class="btn-guardar" (click)="guardarCambios()">
                  <i class="icon-save">ğŸ’¾</i> Guardar Cambios
                </button>
                <button class="btn-cancelar" (click)="toggleEdicion()">Cancelar</button>
              </div>
            </div>
          </div>

          <!-- PestaÃ±a: Direcciones -->
          <div *ngIf="tabActiva === 'direcciones'" class="tab-pane">
            <div class="pane-header">
              <h2><i class="icon-location">ğŸ“</i> Mis Direcciones</h2>
              <div class="pane-acciones">
                <button class="btn-secundario" (click)="cerrarSesion()">
                  <i class="icon-logout">ğŸšª</i> Cerrar SesiÃ³n
                </button>
                <button class="btn-primary" (click)="agregarDireccion()">
                  <i class="icon-plus">â•</i> Agregar DirecciÃ³n
                </button>
              </div>
            </div>

            <div class="direcciones-grid">
              <div *ngFor="let direccion of direcciones; let i = index" class="direccion-card">
                <div class="direccion-header">
                  <div class="direccion-titulo">
                    <h3>{{ direccion.nombre }}</h3>
                    <span *ngIf="direccion.principal" class="badge-principal">
                      <i class="icon-check">âœ…</i> Principal
                    </span>
                  </div>
                  <div class="direccion-acciones">
                    <button class="btn-icon" (click)="editarDireccion(i)" title="Editar">
                      <i class="icon-edit">âœï¸</i>
                    </button>
                    <button class="btn-icon" (click)="eliminarDireccion(i)" title="Eliminar">
                      <i class="icon-trash">ğŸ—‘ï¸</i>
                    </button>
                  </div>
                </div>

                <div class="direccion-info">
                  <p><strong>DirecciÃ³n:</strong> {{ direccion.calle }}, {{ direccion.colonia }}</p>
                  <p><strong>Ciudad:</strong> {{ direccion.ciudad }}, {{ direccion.estado }}</p>
                  <p><strong>C.P.:</strong> {{ direccion.codigoPostal }}</p>
                  <p><strong>Entre calles:</strong> {{ direccion.entreCalles }}</p>
                  <p><strong>Instrucciones:</strong> {{ direccion.instrucciones }}</p>
                </div>

                <div class="direccion-footer">
                  <button
                    *ngIf="!direccion.principal"
                    class="btn-secundario"
                    (click)="establecerPrincipal(i)"
                  >
                    Establecer como principal
                  </button>
                </div>
              </div>
            </div>

            <div *ngIf="direcciones.length === 0" class="sin-direcciones">
              <i class="icon-location-off">ğŸ“</i>
              <h3>No hay direcciones guardadas</h3>
              <p>Agrega una direcciÃ³n para recibir tus pedidos</p>
              <button class="btn-primary" (click)="agregarDireccion()">
                <i class="icon-plus">â•</i> Agregar primera direcciÃ³n
              </button>
            </div>
          </div>

          <!-- PestaÃ±a: Mis Productos -->
          <div *ngIf="tabActiva === 'productos'" class="tab-pane">
            <div class="pane-header">
              <h2><i class="icon-package">ğŸ“¦</i> Mis Productos</h2>
              <div class="pane-acciones">
                <button class="btn-secundario" (click)="cerrarSesion()">
                  <i class="icon-logout">ğŸšª</i> Cerrar SesiÃ³n
                </button>
                <button class="btn-primary" [routerLink]="['/publicar_producto']">
                  <i class="icon-plus">â•</i> Publicar Nuevo Producto
                </button>
              </div>
            </div>

            <!-- Filtros de productos -->
            <div class="productos-filtros">
              <div class="filtros-group">
                <button class="filtro-btn active">Todos</button>
                <button class="filtro-btn">Activos</button>
                <button class="filtro-btn">Pausados</button>
                <button class="filtro-btn">Vendidos</button>
              </div>
              <div class="busqueda-productos">
                <input type="text" placeholder="Buscar producto..." class="search-input" />
                <button class="btn-icon">
                  <i class="icon-search">ğŸ”</i>
                </button>
              </div>
            </div>

            <!-- Lista de productos -->
            <div class="productos-grid">
              <div *ngFor="let producto of productos; let i = index" class="producto-card">
                <div class="producto-imagen">
                  <img [src]="producto.imagen" [alt]="producto.nombre" />
                  <span class="producto-estado" [class]="producto.estado">
                    {{
                      producto.estado === 'activo'
                        ? 'Activo'
                        : producto.estado === 'pausado'
                          ? 'Pausado'
                          : 'Vendido'
                    }}
                  </span>
                </div>

                <div class="producto-info">
                  <h3>{{ producto.nombre }}</h3>
                  <p class="producto-descripcion">{{ producto.descripcion }}</p>
                  <div class="producto-detalles">
                    <span class="producto-precio">${{ producto.precio | number }}</span>
                    <span class="producto-stock">
                      <i class="icon-box">ğŸ“¦</i> {{ producto.stock }} disponibles
                    </span>
                    <span class="producto-visitas">
                      <i class="icon-eye">ğŸ‘ï¸</i> {{ producto.visitas }} vistas
                    </span>
                  </div>
                </div>

                <div class="producto-acciones">
                  <button
                    class="btn-icon btn-icon-warning"
                    (click)="editarProducto(i)"
                    title="Editar"
                  >
                    <i class="icon-edit">âœï¸</i>
                  </button>
                  <button
                    class="btn-icon btn-icon-info"
                    (click)="pausarProducto(i)"
                    [title]="producto.estado === 'activo' ? 'Pausar' : 'Activar'"
                  >
                    <i class="icon-pause">â¸ï¸</i>
                  </button>
                  <button
                    class="btn-icon btn-icon-danger"
                    (click)="eliminarProducto(i)"
                    title="Eliminar"
                  >
                    <i class="icon-trash">ğŸ—‘ï¸</i>
                  </button>
                </div>
              </div>
            </div>

            <div *ngIf="productos.length === 0" class="sin-productos">
              <i class="icon-package-off">ğŸ“¦</i>
              <h3>No hay productos publicados</h3>
              <p>Comienza a publicar tus productos para vender en la plataforma</p>
              <button class="btn-primary" [routerLink]="['/publicar_producto']">
                <i class="icon-plus">â•</i> Publicar primer producto
              </button>
            </div>
          </div>

          <!-- PestaÃ±a: Seguridad -->
          <div *ngIf="tabActiva === 'seguridad'" class="tab-pane">
            <div class="pane-header">
              <h2><i class="icon-shield">ğŸ›¡ï¸</i> Seguridad y Privacidad</h2>
              <div class="pane-acciones">
                <button class="btn-secundario" (click)="cerrarSesion()">
                  <i class="icon-logout">ğŸšª</i> Cerrar SesiÃ³n
                </button>
              </div>
            </div>

            <div class="configuraciones-list">
              <div class="config-item">
                <div class="config-info">
                  <h3><i class="icon-lock">ğŸ”’</i> Cambiar ContraseÃ±a</h3>
                  <p>Actualiza tu contraseÃ±a regularmente para mantener tu cuenta segura</p>
                </div>
                <button class="btn-primary btn-password" (click)="cambiarContrasena()">
                  <i class="icon-key">ğŸ”‘</i> Cambiar ContraseÃ±a
                </button>
              </div>

              <div class="config-item">
                <div class="config-info">
                  <h3><i class="icon-shield-check">âœ…</i> VerificaciÃ³n en dos pasos</h3>
                  <p>AÃ±ade una capa extra de seguridad a tu cuenta</p>
                </div>
                <label class="toggle-switch">
                  <input
                    type="checkbox"
                    [(ngModel)]="verificacionDosPasos"
                    id="verificacionDosPasos"
                  />
                  <span class="toggle-slider"></span>
                </label>
              </div>

              <div class="config-item">
                <div class="config-info">
                  <h3><i class="icon-bell">ğŸ””</i> Notificaciones</h3>
                  <p>Configura cÃ³mo recibir notificaciones sobre tus actividades</p>
                </div>
                <div class="notificaciones-opciones">
                  <label class="checkbox-label">
                    <input
                      type="checkbox"
                      [(ngModel)]="notificacionesEmail"
                      id="notificacionesEmail"
                    />
                    <span class="checkmark"></span>
                    Correo electrÃ³nico
                  </label>
                  <label class="checkbox-label">
                    <input
                      type="checkbox"
                      [(ngModel)]="notificacionesPush"
                      id="notificacionesPush"
                    />
                    <span class="checkmark"></span>
                    Notificaciones push
                  </label>
                </div>
              </div>

              <div class="config-item danger">
                <div class="config-info">
                  <h3><i class="icon-alert-triangle">âš ï¸</i> Eliminar cuenta</h3>
                  <p>Elimina permanentemente tu cuenta y todos tus datos</p>
                </div>
                <button class="btn-danger" (click)="eliminarCuenta()">
                  <i class="icon-trash">ğŸ—‘ï¸</i> Eliminar Cuenta
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>
