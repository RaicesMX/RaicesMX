<div class="ofertas-container">
  <!-- HERO SECTION -->
  <section class="ofertas-hero">
    <div class="mexican-pattern"></div>
    
    <div class="hero-content-wrapper">
      <div class="hero-content">
        <div class="hero-text">
          <h1 class="hero-title">
            <span class="hero-line-1">Descuentos</span>
            <span class="hero-line-2">
              <span class="text-especiales">Especiales</span>
              <span class="text-ofertas">Ofertas</span>
            </span>
          </h1>
          
          <p class="hero-subtitle">
            Aprovecha nuestras mejores ofertas en artesanías mexicanas. ¡Tiempo limitado!
          </p>
          
          <div class="hero-stats">
            <div class="hero-stat">
              <span class="stat-number">{{ obtenerTotalOfertas() }}</span>
              <span class="stat-label">Ofertas</span>
            </div>
            <div class="hero-stat">
              <span class="stat-number">{{ obtenerOfertasActivas() }}</span>
              <span class="stat-label">Activas</span>
            </div>
            <div class="hero-stat">
              <span class="stat-number">{{ calcularAhorroTotal() | currency:'MXN':'symbol' }}</span>
              <span class="stat-label">Ahorro Total</span>
            </div>
          </div>
          
          <div class="hero-cta">
            <button class="btn-explorar btn-glow-effect" (click)="scrollToOfertas()">
              <i class="material-icons btn-icon">local_offer</i>
              <span class="btn-text">Ver Ofertas</span>
            </button>
          </div>
        </div>
        <!-- ELIMINADA LA SECCIÓN HERO-DECORATION CON EMOJIS -->
      </div>
    </div>
    
    <div class="scroll-indicator" (click)="scrollToOfertas()">
      <div class="arrow"></div>
    </div>
  </section>

  <!-- FILTROS RÁPIDOS -->
  <section class="filtros-section">
    <div class="container">
      <div class="filtros-grid">
        <!-- Filtros rápidos -->
        <div class="filtro-card" 
            [class.active]="filtroRapido === 'todas'"
            (click)="aplicarFiltroRapido('todas')">
          <div class="filtro-icon">
            <i class="material-icons">all_inclusive</i>
          </div>
          <div class="filtro-content">
            <h4>Todas</h4>
            <p>Todas las ofertas</p>
          </div>
        </div>
        
        <div class="filtro-card" 
            [class.active]="filtroRapido === 'destacadas'"
            (click)="aplicarFiltroRapido('destacadas')">
          <div class="filtro-icon">
            <i class="material-icons">whatshot</i>
          </div>
          <div class="filtro-content">
            <h4>Destacadas</h4>
            <p>Ofertas especiales</p>
          </div>
        </div>
        
        <div class="filtro-card"
            [class.active]="filtroRapido === 'exclusivas'"
            (click)="aplicarFiltroRapido('exclusivas')">
          <div class="filtro-icon">
            <i class="material-icons">star</i>
          </div>
          <div class="filtro-content">
            <h4>Exclusivas</h4>
            <p>Solo en RaícesMX</p>
          </div>
        </div>
        
        <!-- Dropdown de categorías -->
        <div class="filtro-card dropdown-filtro">
          <div class="filtro-icon">
            <i class="material-icons">category</i>
          </div>
          <div class="filtro-content">
            <select [(ngModel)]="filtroCategoria" (change)="filtrarOfertas()" class="categoria-select">
              <option value="">Todas las categorías</option>
              <option *ngFor="let categoria of categoriasUnicas" [value]="categoria">
                {{ categoria }}
              </option>
            </select>
          </div>
        </div>
      </div>
      
      <!-- Controles adicionales -->
      <div class="filtros-footer">
        <div class="ordenamiento">
          <label for="ordenSelect">Ordenar por:</label>
            <select id="ordenSelect" [(ngModel)]="ordenSeleccionado" (change)="ordenarOfertas()" class="orden-select">
            <option value="descuento">Mayor descuento</option>
            <option value="precio">Menor precio</option>
            <option value="popular">Más populares</option>
            <option value="nuevo">Más recientes</option>
          </select>
        </div>
        
        <button class="btn-filtros-avanzados btn-glow-subtle" (click)="mostrarFiltrosAvanzados = !mostrarFiltrosAvanzados">
          {{ mostrarFiltrosAvanzados ? 'Menos filtros' : 'Más filtros' }}
        </button>
        
        <button class="btn-limpiar btn-glow-effect btn-glow-subtle" (click)="limpiarFiltros()" *ngIf="filtroActivo">
          <i class="material-icons btn-icon">refresh</i>
          Limpiar filtros
        </button>
      </div>
      
      <!-- Filtros avanzados -->
      <div class="filtros-avanzados" *ngIf="mostrarFiltrosAvanzados">
        <div class="filtro-avanzado">
          <span>Descuento mínimo</span>
          <div class="descuento-options">
            <button *ngFor="let desc of ['10', '20', '30', '40', '50']"
                    class="descuento-btn"
                    [class.active]="filtroDescuento === desc"
                    (click)="filtroDescuento = filtroDescuento === desc ? '' : desc; filtrarOfertas()">
              {{ desc }}%+
            </button>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- SECCIÓN DE OFERTAS -->
  <section class="ofertas-section" id="ofertas" #ofertasSection>
    <div class="container">
      <div class="section-header">
        <h2 class="section-title">Nuestras Ofertas</h2>
        <div class="resultados-count">
          <span class="count-number">{{ ofertasFiltradas.length }}</span>
          <span class="count-text">
            {{ ofertasFiltradas.length === 1 ? 'oferta' : 'ofertas' }}
          </span>
        </div>
      </div>
      
      <!-- Estado de carga -->
      <div class="loading-state" *ngIf="cargando">
        <div class="spinner"></div>
        <p>Cargando ofertas...</p>
      </div>
      
      <!-- Grid de ofertas -->
      <div class="ofertas-grid" *ngIf="!cargando">
        <div class="oferta-card" *ngFor="let oferta of ofertasFiltradas">
          
          <!-- Imagen con fallback -->
          <div class="oferta-imagen">
            <img 
              [src]="oferta.imagen" 
              [alt]="oferta.nombre"
              (error)="onImgError($event, oferta)"
              (load)="onImgLoad(oferta)"
              loading="lazy"
            />
            
            <!-- Badges -->
            <div class="oferta-badges">
              <span class="badge badge-descuento">-{{ oferta.descuento }}%</span>
              <span class="badge badge-destacada" *ngIf="oferta.destacada">
                <i class="material-icons">whatshot</i> Destacada
              </span>
              <span class="badge badge-exclusiva" *ngIf="oferta.exclusivo">
                <i class="material-icons">star</i> Exclusiva
              </span>
              <span class="badge badge-agotado" *ngIf="oferta.stock === 0">
                <i class="material-icons">mood_bad</i> Agotado
              </span>
              <span class="badge badge-stock" *ngIf="oferta.stock <= 5 && oferta.stock > 0">
                <i class="material-icons">schedule</i> Últimas {{ oferta.stock }}
              </span>
            </div>
            
            <!-- Timer -->
            <div class="oferta-timer" *ngIf="oferta.tiempoRestante && oferta.stock > 0">
              <div class="timer-progress">
                <div class="progress-bar" [style.width]="calcularProgresoTiempo(oferta) + '%'"></div>
              </div>
              <div class="timer-text">
                <i class="material-icons">schedule</i> {{ oferta.tiempoRestante.dias }}d {{ oferta.tiempoRestante.horas }}h
              </div>
            </div>
          </div>
          
          <!-- Contenido -->
          <div class="oferta-content">
            <h3 class="oferta-nombre">{{ oferta.nombre }}</h3>
            
            <p class="oferta-descripcion">{{ oferta.descripcionCorta }}</p>
            
            <!-- Artesano y región -->
            <div class="oferta-artesano">
              <i class="material-icons">palette</i>
              <span class="artesano-nombre">{{ oferta.artesano }}</span>
              <span class="artesano-region">· {{ oferta.region }}</span>
            </div>
            
            <!-- Stats -->
            <div class="oferta-stats">
              <div class="stat">
                <i class="material-icons">star</i>
                <span class="stat-value">{{ oferta.rating }}</span>
                <span class="stat-label">Rating</span>
              </div>
              <div class="stat">
                <i class="material-icons">inventory_2</i>
                <span class="stat-value">{{ oferta.stock }}</span>
                <span class="stat-label">Stock</span>
              </div>
              <div class="stat">
                <i class="material-icons">shopping_cart</i>
                <span class="stat-value">{{ oferta.vendidos }}</span>
                <span class="stat-label">Vendidos</span>
              </div>
            </div>
            
            <!-- Precios -->
            <div class="oferta-precios">
              <div class="precio-oferta">
                {{ calcularPrecioOferta(oferta) | currency:'MXN':'symbol' }}
              </div>
              <div class="precio-original">
                {{ oferta.precio | currency:'MXN':'symbol' }}
              </div>
              <div class="ahorro">
                <i class="material-icons">savings</i> Ahorras {{ calcularAhorro(oferta) | currency:'MXN':'symbol' }}
              </div>
            </div>
            
            <!-- Acciones -->
            <div class="oferta-actions">
              <button class="btn-agregar-carrito btn-glow-effect" 
                      (click)="agregarAlCarrito(oferta)"
                      [disabled]="oferta.stock === 0">
                <i class="material-icons">shopping_cart</i>
                <span *ngIf="oferta.stock > 0">Agregar</span>
                <span *ngIf="oferta.stock === 0">Agotado</span>
              </button>
              
              <button class="btn-comprar-ahora btn-glow-effect" 
                      (click)="comprarAhora(oferta)"
                      [disabled]="oferta.stock === 0">
                <i class="material-icons">shopping_bag</i>
                <span *ngIf="oferta.stock > 0">Comprar</span>
                <span *ngIf="oferta.stock === 0">No disponible</span>
              </button>
              
              <button class="btn-favorito btn-glow-subtle" (click)="toggleFavorito(oferta)">
                <i class="material-icons">{{ oferta.enFavoritos ? 'favorite' : 'favorite_border' }}</i>
              </button>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Sin resultados -->
      <div class="no-resultados" *ngIf="!cargando && ofertasFiltradas.length === 0">
        <div class="no-resultados-icon">
          <i class="material-icons">search_off</i>
        </div>
        <h3>No encontramos ofertas</h3>
        <p>Prueba con otros filtros o revisa más tarde</p>
        <button class="btn-limpiar btn-glow-effect btn-glow-subtle" (click)="limpiarFiltros()">
          <i class="material-icons btn-icon">refresh</i>
          Ver todas las ofertas
        </button>
      </div>
    </div>
  </section>

  <!-- INFORMACIÓN ADICIONAL -->
  <section class="info-section">
    <div class="container">
      <h2 class="info-title">¿Cómo funcionan nuestras ofertas?</h2>
      <div class="info-grid">
        <div class="info-card">
          <div class="info-icon">
            <i class="material-icons">schedule</i>
          </div>
          <h3>Tiempo Limitado</h3>
          <p>Cada oferta tiene una duración específica</p>
        </div>
        <div class="info-card">
          <div class="info-icon">
            <i class="material-icons">verified</i>
          </div>
          <h3>Calidad Garantizada</h3>
          <p>Misma calidad que nuestros productos regulares</p>
        </div>
        <div class="info-card">
          <div class="info-icon">
            <i class="material-icons">local_shipping</i>
          </div>
          <h3>Envío Gratis</h3>
          <p>En ofertas especiales sobre $500 MXN</p>
        </div>
      </div>
    </div>
  </section>
</div>