<div class="favoritos-container">
  <!-- HERO SECTION -->
  <section class="favoritos-hero">
    <div class="mexican-pattern"></div>
    
    <div class="hero-content-wrapper">
      <div class="hero-content">
        <div class="hero-text">
          <h1 class="hero-title">
            <span class="hero-accent">Tus</span>
            <span class="hero-line">
              <span class="text-favoritos">Favoritos</span>
              <span class="text-mx">MX</span>
            </span>
          </h1>
          
          <p class="hero-subtitle">
            Guarda tus artesanías mexicanas favoritas y regresa cuando estés listo para comprar
          </p>
          
          <div class="hero-stats">
            <div class="hero-stat">
              <span class="stat-number">{{ productosFavoritos.length }}</span>
              <span class="stat-label">Productos</span>
            </div>
            <div class="hero-stat">
              <span class="stat-number">{{ obtenerTotalCategorias() }}</span>
              <span class="stat-label">Categorías</span>
            </div>
            <div class="hero-stat">
              <span class="stat-number">{{ calcularValorTotal() | currency:'MXN':'symbol' }}</span>
              <span class="stat-label">Valor Total</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- BARRA DE ACCIONES Y FILTROS -->
  <section class="filtros-section">
    <div class="container">
      <div class="filtros-footer">
        <div class="ordenamiento">
          <label>Ordenar por:</label>
          <select [(ngModel)]="ordenSeleccionado" (change)="ordenarFavoritos()" class="orden-select">
            <option value="reciente">Más recientes</option>
            <option value="antiguo">Más antiguos</option>
            <option value="precio-asc">Precio: Menor a Mayor</option>
            <option value="precio-desc">Precio: Mayor a Menor</option>
            <option value="nombre">Nombre A-Z</option>
          </select>
        </div>
        
        <div class="filtro-group">
          <select [(ngModel)]="filtroCategoria" (change)="filtrarFavoritos()" class="categoria-select">
            <option value="">Todas las categorías</option>
            <option *ngFor="let cat of categoriasUnicas" [value]="cat">{{ cat }}</option>
          </select>
        </div>
        
        <div class="acciones-masivas" *ngIf="productosFavoritos.length > 0">
          <button class="btn-mover-todo btn-glow-effect" (click)="moverTodoAlCarrito()">
            <i class="material-icons">shopping_cart</i>
            <span class="btn-text">Mover Todo al Carrito</span>
          </button>
          <button class="btn-limpiar btn-glow-effect btn-glow-subtle" (click)="limpiarFavoritos()">
            <i class="material-icons">delete</i>
            <span class="btn-text">Limpiar Favoritos</span>
          </button>
        </div>
      </div>
    </div>
  </section>

  <!-- ESTADO VACÍO -->
  <section *ngIf="productosFavoritos.length === 0" class="favoritos-vacio">
    <div class="container">
      <div class="no-resultados">
        <div class="no-resultados-icon">
          <i class="material-icons">favorite_border</i>
        </div>
        <h3>Tu lista de favoritos está vacía</h3>
        <p>Descubre artesanías únicas y guárdalas aquí para verlas después</p>
        <div class="vacio-actions">
          <button class="btn-explorar btn-glow-effect" routerLink="/marketplace">
            <i class="material-icons">explore</i>
            <span class="btn-text">Explorar Productos</span>
          </button>
          <button class="btn-ofertas btn-glow-effect btn-glow-subtle" routerLink="/ofertas">
            <i class="material-icons">local_offer</i>
            <span class="btn-text">Ver Ofertas Especiales</span>
          </button>
        </div>
      </div>
    </div>
  </section>

  <!-- GRID DE PRODUCTOS FAVORITOS -->
  <section *ngIf="productosFavoritos.length > 0" class="favoritos-section">
    <div class="container">
      <div class="section-header">
        <h2 class="section-title">{{ productosFiltrados.length }} Productos Favoritos</h2>
        <div class="resultados-count" *ngIf="filtroActivo">
          <span class="filtro-text">· Filtrados</span>
        </div>
      </div>
      
      <div class="favoritos-grid">
        <div *ngFor="let producto of productosFiltrados; let i = index" 
             class="producto-favorito-card"
             [class.en-oferta]="producto.oferta"
             [class.agotado]="producto.stock === 0">
          
          <!-- Badges -->
          <div class="producto-badges">
            <span *ngIf="producto.oferta" class="badge badge-oferta">
              <i class="material-icons">local_offer</i> {{ producto.descuento }}% OFF
            </span>
            <span *ngIf="producto.stock === 0" class="badge badge-agotado">
              <i class="material-icons">mood_bad</i> Agotado
            </span>
            <span *ngIf="producto.nuevo" class="badge badge-nuevo">
              <i class="material-icons">fiber_new</i> Nuevo
            </span>
            <span class="badge badge-categoria">
              {{ producto.categoria }}
            </span>
          </div>

          <!-- Imagen del producto -->
          <div class="producto-imagen">
            <img [src]="producto.imagen" [alt]="producto.nombre">
            <div class="producto-overlay">
              <div class="overlay-actions">
                <button class="btn-action btn-ver btn-glow-subtle" (click)="verProducto(producto)">
                  <i class="material-icons">visibility</i>
                  Ver
                </button>
                <button class="btn-action btn-carrito btn-glow-effect" 
                        (click)="agregarAlCarrito(producto)"
                        [disabled]="producto.stock === 0">
                  <i class="material-icons">shopping_cart</i>
                  {{ producto.stock === 0 ? 'Agotado' : 'Carrito' }}
                </button>
              </div>
            </div>
          </div>

          <!-- Información del producto -->
          <div class="producto-info">
            <div class="producto-header">
              <h3 class="producto-nombre">{{ producto.nombre }}</h3>
              <button class="btn-quitar-favorito" (click)="quitarDeFavoritos(i)">
                <i class="material-icons">close</i>
              </button>
            </div>

            <p class="producto-descripcion">{{ producto.descripcion }}</p>

            <div class="producto-artesano">
              <i class="material-icons">palette</i>
              <span class="artesano-nombre">{{ producto.artesano }}</span>
              <span class="artesano-region">· {{ producto.region }}</span>
            </div>

            <!-- Rating y reviews -->
            <div class="producto-rating">
              <div class="rating-stars">
                <i *ngFor="let star of [1,2,3,4,5]" 
                   class="material-icons star" 
                   [class.filled]="star <= producto.rating">star</i>
              </div>
              <span class="rating-value">({{ producto.reviews }})</span>
            </div>

            <!-- Precio y stock -->
            <div class="producto-precio-stock">
              <div class="precio-info">
                <span class="precio-actual" *ngIf="producto.oferta">
                  {{ calcularPrecioOferta(producto) | currency:'MXN':'symbol' }}
                </span>
                <span class="precio-original" [class.tachado]="producto.oferta">
                  {{ producto.precio | currency:'MXN':'symbol' }}
                </span>
              </div>
              <div class="stock-info">
                <span class="stock-text" [class.agotado]="producto.stock === 0">
                  <i class="material-icons">{{ producto.stock === 0 ? 'cancel' : 'check_circle' }}</i>
                  {{ producto.stock === 0 ? 'Agotado' : producto.stock + ' disponibles' }}
                </span>
              </div>
            </div>

            <!-- Fecha agregado -->
            <div class="producto-fecha">
              <i class="material-icons">calendar_today</i>
              <span class="fecha-text">Agregado {{ calcularTiempo(producto.fechaAgregado) }}</span>
            </div>

            <!-- Acciones rápidas -->
            <div class="producto-acciones">
              <button class="btn-rapido btn-comprar btn-glow-effect" 
                      (click)="comprarAhora(producto)"
                      [disabled]="producto.stock === 0">
                <i class="material-icons">shopping_cart</i>
                Comprar Ahora
              </button>
              <button class="btn-rapido btn-compartir btn-glow-subtle" (click)="compartirProducto(producto)">
                <i class="material-icons">share</i>
                Compartir
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- RECOMENDACIONES -->
  <section *ngIf="productosFavoritos.length > 0" class="recomendaciones-section">
    <div class="container">
      <div class="section-header">
        <h2 class="section-title">Productos que te pueden gustar</h2>
        <p class="section-subtitle">Basado en tus favoritos</p>
      </div>
      
      <div class="recomendaciones-grid">
        <div *ngFor="let recomendacion of productosRecomendados"  
            class="recomendacion-card"
            (click)="verProducto(recomendacion)">
          
          <div class="recomendacion-imagen">
            <img [src]="recomendacion.imagen" [alt]="recomendacion.nombre">
          </div>
          
          <div class="recomendacion-info">
            <h4>{{ recomendacion.nombre }}</h4>
            <p class="recomendacion-precio">{{ recomendacion.precio | currency:'MXN':'symbol' }}</p>
            <button class="btn-recomendacion btn-glow-subtle" 
                    (click)="$event.stopPropagation(); agregarAFavoritos(recomendacion)">
              <i class="material-icons">favorite_border</i>
              Guardar
            </button>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- TIPS -->
  <section class="tips-section">
    <div class="container">
      <h2 class="info-title">Tips para tus favoritos</h2>
      <div class="info-grid">
        <div class="info-card">
          <div class="info-icon">
            <i class="material-icons">shopping_cart</i>
          </div>
          <h3>Múevelos al carrito</h3>
          <p>Cuando estés listo para comprar</p>
        </div>
        <div class="info-card">
          <div class="info-icon">
            <i class="material-icons">visibility</i>
          </div>
          <h3>Revisa el stock</h3>
          <p>Las artesanías son únicas</p>
        </div>
        <div class="info-card">
          <div class="info-icon">
            <i class="material-icons">chat</i>
          </div>
          <h3>Comparte con amigos</h3>
          <p>Para pedir opiniones</p>
        </div>
      </div>
    </div>
  </section>
</div>